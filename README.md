
# SQL Query Practice: Beginner to Master Level

This repository contains a collection of SQL query exercises designed to help you practice and master SQL using a sample `Retail` table with the following columns:

### ðŸ“Š Table Structure: `Retail`

```sql
customer_id INT,
sale_date DATE,
sale_time TIME,
gender VARCHAR(10),
age INT,
category VARCHAR(50),
quantity INT,
price_per_unit DECIMAL(10, 2),
total_sale DECIMAL(10, 2),
year INT,
month INT,
timeofday VARCHAR(20),
name_day VARCHAR(20)
```

---

## ðŸŸ¢ Beginner Level

### 1. Get all records from the table

```sql
SELECT * FROM Retail;
```

### 2. Show unique categories of products

```sql
SELECT DISTINCT category FROM Retail;
```

### 3. Count total number of sales transactions

```sql
SELECT COUNT(*) AS total_transactions FROM Retail;
```

### 4. Find total sale amount for each customer

```sql
SELECT customer_id, SUM(total_sale) AS total_spent
FROM Retail
GROUP BY customer_id;
```

### 5. Show sales made in the month of January

```sql
SELECT * FROM Retail
WHERE month = 1;
```

---

## ðŸŸ¡ Intermediate Level

### 6. Calculate average price per unit for each category

```sql
SELECT category, AVG(price_per_unit) AS avg_price
FROM Retail
GROUP BY category;
```

### 7. Find the highest sale transaction

```sql
SELECT * FROM Retail
ORDER BY total_sale DESC
LIMIT 1;
```

### 8. Get number of products sold by gender

```sql
SELECT gender, SUM(quantity) AS total_quantity
FROM Retail
GROUP BY gender;
```

### 9. List total sales per day

```sql
SELECT sale_date, SUM(total_sale) AS daily_sales
FROM Retail
GROUP BY sale_date;
```

### 10. Find customers who made purchases in more than one month

```sql
SELECT customer_id, COUNT(DISTINCT month) AS months_active
FROM Retail
GROUP BY customer_id
HAVING COUNT(DISTINCT month) > 1;
```

---

## ðŸ”´ Advanced Level

### 11. Calculate total sales by time of day (morning, afternoon, evening)

```sql
SELECT timeofday, SUM(total_sale) AS total_sales
FROM Retail
GROUP BY timeofday;
```

### 12. Find top 3 customers with highest total sales

```sql
SELECT customer_id, SUM(total_sale) AS total_spent
FROM Retail
GROUP BY customer_id
ORDER BY total_spent DESC
LIMIT 3;
```

### 13. Monthly sales trend for each category

```sql
SELECT category, month, SUM(total_sale) AS monthly_sales
FROM Retail
GROUP BY category, month
ORDER BY category, month;
```

### 14. Find the average age of customers buying each category

```sql
SELECT category, AVG(age) AS avg_age
FROM Retail
GROUP BY category;
```

### 15. Get sales data only for weekends

```sql
SELECT * FROM Retail
WHERE name_day IN ('Saturday', 'Sunday');
```

### 16. Find the total revenue generated by each product in the last 2 years

#### For SQL Server:

```sql
SELECT category, SUM(total_sale) AS total_revenue
FROM Retail
WHERE sale_date >= DATEADD(year, -2, CAST(GETDATE() AS date))
GROUP BY category;
```

#### For PostgreSQL:

```sql
SELECT category, SUM(total_sale) AS total_revenue
FROM Retail
WHERE sale_date >= CURRENT_DATE - INTERVAL '2 years'
GROUP BY category;
```

---

### 17. How many orders were placed on each weekday, and which weekday had the highest number of orders?

#### PostgreSQL:

```sql
SELECT 
  TO_CHAR(sale_date, 'Day') AS week_day,
  COUNT(*) AS total_orders
FROM Retail
GROUP BY week_day
ORDER BY total_orders DESC;
```

#### MySQL:

```sql
SELECT 
  DAYNAME(sale_date) AS week_day,
  COUNT(*) AS total_orders
FROM Retail
GROUP BY week_day
ORDER BY total_orders DESC;
```

### 17.How many orders were placed each month across different years, and which month had the most orders overall??

```sql
SELECT 
  TO_CHAR(sale_date, 'Month') AS months,
  EXTRACT(YEAR FROM sale_date) AS years,
  COUNT(id) AS total_order
FROM retail
GROUP BY years, months
ORDER BY total_order DESC;

```
### 18.What is the earliest sale date (after subtracting 2 years) and the total number of orders for each category, grouped by the adjusted date?

```sql
SELECT 
    category,
    MIN(DATEADD(year, -2, sale_date)) AS one_year_later,
    COUNT(id) AS total
FROM retail_database.dbo.Retail
GROUP BY category, DATEADD(year, -2, sale_date);

```
### 18.How many days did it take to deliver each customer's order based on the order date and delivery date?

```sql
SELECT 
    c.name, 
    o.order_date,
    o.delivery_date,
    DATEDIFF(day, o.order_date, o.delivery_date) AS duration_days
FROM 
    customers AS c
JOIN 
    orders AS o ON c.customer_id = o.customer_id;

```

## âœ… Tools Supported

- PostgreSQL   
- SQL Server 

---

Feel free to contribute or fork the project!
